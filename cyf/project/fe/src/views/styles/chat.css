.chat-container {
  height: 100vh;
  display: flex;
  flex-direction: column;
  background: linear-gradient(135deg, #f0f7f9 0%, #e8f2f5 100%);
  /* 修复移动端视口高度问题 */
  height: -webkit-fill-available;
}

.chat-header {
  background: rgba(255, 255, 255, 0.9);
  backdrop-filter: blur(10px);
  padding: 16px 24px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  border-bottom: 1px solid rgba(144, 200, 248, 0.3);
  box-shadow: 0 2px 10px rgba(144, 200, 248, 0.1);
  flex-shrink: 0; /* 防止头部被压缩 */
  min-height: 60px; /* 确保头部有最小高度，防止内容拥挤 */
}

/* 移动端头部布局优化 */
@media (max-width: 768px) {
  .chat-header {
    flex-wrap: nowrap; /* 防止头部换行 */
    padding: 12px 16px;
    align-items: center; /* 确保内容垂直居中 */
    min-height: 50px;
  }

  .header-right {
    display: flex;
    align-items: center;
    gap: 8px;
    flex-shrink: 0; /* 防止右侧按钮区域被压缩 */
  }

  .header-left {
    flex-grow: 1; /* 让左侧内容占据剩余空间 */
    min-width: 0; /* 允许flex项目收缩 */
  }
}

.chat-header {
  background: rgba(255, 255, 255, 0.9);
  backdrop-filter: blur(10px);
  padding: 16px 24px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  border-bottom: 1px solid rgba(144, 180, 248, 0.3);
  box-shadow: 0 2px 10px rgba(144, 180, 248, 0.1);
}

.header-left {
  display: flex;
  align-items: center;
  gap: 16px;
  flex-wrap: wrap;
}

.header-left h2 {
  color: #5a7bc1;
  font-size: 20px;
  font-weight: 600;
  margin: 0;
  flex-shrink: 0;
}

.user-info {
  color: #7a9ccc;
  font-size: 14px;
  flex-shrink: 0;
  max-width: 150px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

/* 确保header-right的按钮在移动端并排显示 */
.header-right {
  display: flex;
  align-items: center;
  gap: 8px;
}

.chat-main {
  flex: 1;
  display: flex;
  overflow: hidden;
}

.chat-sidebar {
  width: 320px;
  background: rgba(255, 255, 255, 0.9);
  backdrop-filter: blur(10px);
  padding: 20px;
  border-right: 1px solid rgba(144, 180, 248, 0.3);
  overflow-y: auto;
  /* 新增以下属性 */
  -webkit-overflow-scrolling: touch;  /* 启用惯性滚动 */
  touch-action: pan-y;                 /* 只允许垂直滚动 */
  overscroll-behavior: contain;        /* 防止滚动链 */
}

.model-selector {
  margin-bottom: 30px;
}

.model-selector h3 {
  color: #5a7bc1;
  font-size: 16px;
  margin-bottom: 12px;
}

.provider-selector {
  margin-bottom: 10px;
}

/* 针对新模型选择器的移动端优化 */
@media (max-width: 480px) {
  .provider-selector,
  .model-selector {
    width: 100%;
  }

  .provider-selector :deep(.el-select),
  .model-selector :deep(.el-select) {
    width: 100%;
  }
}

.dialog-history-section {
  margin-bottom: 30px;
}

.dialog-history-section h3 {
  color: #5a7bc1;
  font-size: 16px;
  margin-bottom: 12px;
}

.dialog-list {
  max-height: 200px;
  overflow-y: auto;
  border: 1px solid #dcdcdc;
  border-radius: 8px;
  padding: 10px;
  background: rgba(255, 255, 255, 0.7);
  -webkit-overflow-scrolling: touch;
  touch-action: pan-y;
  overscroll-behavior: contain;
  /* 其他现有样式保持不变 */
}

.dialog-item {
  padding: 8px;
  margin-bottom: 8px;
  border-radius: 6px;
  cursor: pointer;
  background: rgba(232, 240, 255, 0.5);
  transition: background-color 0.2s;
  display: flex;
  align-items: center;
  gap: 8px;
  position: relative; /* 添加定位上下文 */
}

.dialog-item.selected {
  background: rgba(144, 180, 248, 0.5);
  outline: 2px solid rgba(144, 180, 248, 0.8);
}

.dialog-item:hover {
  background: rgba(144, 180, 248, 0.3);
}

.dialog-content {
  flex: 1;
  cursor: pointer;
}

.dialog-checkbox {
  margin-right: 8px;
}

.delete-btn {
  visibility: hidden;
  opacity: 0;
  transition: visibility 0.2s, opacity 0.2s;
}

.dialog-item:hover .delete-btn {
  visibility: visible;
  opacity: 1;
}

.dialog-item:last-child {
  margin-bottom: 0;
}

.dialog-title {
  font-weight: 500;
  color: #5a7bc1;
  font-size: 14px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.dialog-content {
  flex: 1;
  cursor: pointer;
  min-width: 0; /* 允许flex项目收缩 */
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.dialog-date {
  font-size: 12px;
  color: #7a9ccc;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.history-section-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 12px;
}

.history-actions {
  display: flex;
  gap: 8px;
  align-items: center;
}

.edit-mode-actions {
  display: flex;
  gap: 8px;
}

.no-dialogs {
  padding: 10px;
  color: #7a9ccc;
  font-style: italic;
  text-align: center;
}

.file-upload-section h3 {
  color: #5a7bc1;
  font-size: 16px;
  margin-bottom: 12px;
}

.upload-demo {
  border: 2px dashed #c0d8e8;
  border-radius: 8px;
  background: rgba(232, 240, 255, 0.3);
}

.upload-demo:hover {
  border-color: #90d8ff;
  background: rgba(232, 240, 255, 0.5);
}

.chat-content {
  flex: 1;
  display: flex;
  flex-direction: column;
  background: rgba(255, 255, 255, 0.7);
}

.chat-toolbar {
  padding: 10px 20px;
  background: rgba(255, 255, 255, 0.8);
  border-bottom: 1px solid rgba(144, 180, 248, 0.3);
  display: flex;
  justify-content: space-between;
  align-items: center;
}

/* 桌面端toolbar样式 */
.toolbar-desktop {
  width: 100%;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

/* 移动端toolbar样式 */
.toolbar-mobile {
  width: 100%;
  display: flex;
  justify-content: flex-end;
}

.mobile-toolbar-btn {
  margin-left: auto;
}

/* 移动端抽屉内容样式 */
.mobile-toolbar-content {
  display: flex;
  flex-direction: column;
  gap: 20px;
}

.mobile-form-label {
  display: block;
  margin-bottom: 8px;
  font-weight: 500;
  color: #5a7bc1;
}

.drawer-button {
  width: 100%;
  margin-bottom: 10px;
}

.drawer-button:last-child {
  margin-bottom: 0;
}

.dialog-title-editor {
  flex: 1;
  max-width: 460px;
  margin-right: 10px;
}

.messages-container {
  flex: 1;
  overflow-x: auto; /* 添加横向滚动 */
  overflow-y: auto;
  padding: 20px;
  -webkit-overflow-scrolling: touch; /* 启用触摸滚动 */
}

.message {
  display: flex;
  gap: 12px;
  margin-bottom: 20px;
}

.message.user {
  flex-direction: row-reverse;
}

.message-avatar {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  background: linear-gradient(135deg, #9acd32 0%, #7dd87d 100%);
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  font-size: 18px;
  flex-shrink: 0;
}

.message.user .message-avatar {
  background: linear-gradient(135deg, #87ceeb 0%, #5f9ea0 100%);
}

.message-content {
  max-width: 70%;
}

.message-header {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 4px;
}

.message-author {
  font-weight: 500;
  color: #5a7bc1;
  font-size: 14px;
}

.message-time {
  color: #7a9ccc;
  font-size: 12px;
}

.message-actions {
  margin-left: auto;
  display: flex;
  gap: 4px;
}

.message-actions .el-button {
  color: #7a9ccc;
  opacity: 0;
  transition: opacity 0.3s;
}

.message:hover .message-actions .el-button {
  opacity: 1;
}

.message-text {
  background: rgba(255, 255, 255, 0.9);
  padding: 12px 16px;
  border-radius: 12px;
  border: 1px solid rgba(144, 180, 248, 0.3);
  color: #333;
  line-height: 1.5;
  white-space: pre-line; /* 更改：保留换行符，但合并空格和制表符 */
  overflow-wrap: break-word; /* 确保长单词能换行 */
  margin-bottom: 0; /* 确保底部没有额外边距 */
}

/* 处理末尾的换行符问题 */
.message-text br:last-child {
  display: none;
}

/* 确保Markdown渲染后的元素也没有多余的底部边距 */
.message-text > :last-child {
  margin-bottom: 0;
}

/* 对特定元素的处理 */
.message-text p:last-child {
  margin-bottom: 0;
}

.message-text pre {
  max-width: 100%;
  overflow-x: auto;
  white-space: pre;
  min-width: 0;
}

@media (max-width: 480px) {
  .message-text pre {
    white-space: pre-wrap;
    overflow-x: hidden;
    overflow-wrap: anywhere;
  }
}

.message-text div:last-child {
  margin-bottom: 0;
}

/* Markdown 内容的特殊样式 */
.message-text :deep(*) {
  max-width: 100%;
  overflow-wrap: break-word;
  word-wrap: break-word;
  word-break: break-word;
  box-sizing: border-box;
}

.message-text :deep(p) {
  margin: 0 0 1em 0;
  max-width: 100%;
  overflow-wrap: break-word;
  word-wrap: break-word;
  word-break: break-word;
  box-sizing: border-box;
}

.message-text :deep(h1),
.message-text :deep(h2),
.message-text :deep(h3),
.message-text :deep(h4),
.message-text :deep(h5),
.message-text :deep(h6) {
  margin: 0.5em 0;
  max-width: 100%;
  overflow-wrap: break-word;
  word-wrap: break-word;
  word-break: break-word;
  box-sizing: border-box;
}

.message-text :deep(pre) {
  background: #2d2d2d !important;
  color: white !important;
  padding: 12px;
  border-radius: 8px;
  overflow-x: auto;
  margin: 10px 0;
  font-family: 'Courier New', monospace;
  line-height: 1.4;
  max-width: 100vw;
  width: auto;
  display: block;
  box-sizing: border-box;
  word-wrap: break-word;
  white-space: pre-wrap;
  word-break: break-word;
  /* 特别针对安卓设备的优化 */
  -webkit-overflow-scrolling: touch;
}

.message-text :deep(code) {
  font-family: 'Courier New', monospace;
  background: rgba(0, 0, 0, 0.05);
  color: #333;
  padding: 2px 6px;
  border-radius: 4px;
  font-size: 0.9em;
  max-width: 100vw;
  overflow-x: auto;
  word-wrap: break-word;
  box-decoration-break: clone;
  box-sizing: border-box;
  word-break: break-word;
  display: inline-block;
  vertical-align: middle;
}

.message-text :deep(pre code) {
  background: none !important;
  color: white !important;
  padding: 0 !important;
  font-size: 0.9em;
  white-space: pre-wrap;
}

.message-text :deep(blockquote) {
  border-left: 3px solid #90d8ff;
  padding-left: 12px;
  margin: 10px 0;
  color: #666;
  max-width: 100%;
  overflow-wrap: break-word;
  word-wrap: break-word;
  word-break: break-word;
  box-sizing: border-box;
}

.message-text :deep(ul),
.message-text :deep(ol) {
  padding-left: 20px;
  margin: 10px 0;
  max-width: 100%;
  overflow-wrap: break-word;
  word-wrap: break-word;
  word-break: break-word;
  box-sizing: border-box;
}

.message-text :deep(li) {
  margin: 5px 0;
  max-width: 100%;
  overflow-wrap: break-word;
  word-wrap: break-word;
  word-break: break-word;
  box-sizing: border-box;
}

.message-text :deep(table) {
  width: fit-content;
  max-width: 100%;
  border-collapse: collapse;
  margin: 10px 0;
  table-layout: fixed; /* 固定表格布局以防止内容溢出 */
  overflow-x: auto;
  display: block;
  box-sizing: border-box;
  /* 使用滚动容器确保表格在小屏幕上可读 */
  -webkit-overflow-scrolling: touch;
}

.message-text :deep(th),
.message-text :deep(td) {
  border: 1px solid #ccc;
  padding: 8px;
  text-align: left;
  word-break: break-word; /* 确保长内容能正确换行 */
  overflow-wrap: break-word;
  box-sizing: border-box;
  vertical-align: top; /* 确保单元格内容顶部对齐 */
  min-width: 40px; /* 最小宽度确保内容可读 */
  max-width: 250px; /* 限制最大宽度防止溢出 */
}

.message-text :deep(*) {
  max-width: 100%;
  overflow-wrap: break-word;
  word-wrap: break-word;
  word-break: break-word;
  box-sizing: border-box;
}

.message.user .message-text {
  background: rgba(144, 180, 248, 0.2);
  border-color: rgba(144, 180, 248, 0.5);
}

/* 移动端适配：确保代码块和表格不超出容器 */
@media (max-width: 768px) {
  .message-text :deep(pre) {
    max-width: 100vw;
    width: auto;
    overflow-x: auto;
    word-wrap: break-word;
    white-space: pre-wrap; /* 允许长行换行 */
    box-sizing: border-box;
    /* 使用更适合移动端的滚动行为 */
    -webkit-overflow-scrolling: touch;
  }

  .message-text :deep(code) {
    max-width: 100vw;
    overflow-x: auto;
    word-wrap: break-word;
    word-break: break-word;
    box-sizing: border-box;
  }

  .message-text :deep(table) {
    max-width: 100%;
    width: fit-content;
    overflow-x: auto;
    display: block;
    table-layout: fixed;
    box-sizing: border-box;
    /* 确保表格容器能够滚动 */
    -webkit-overflow-scrolling: touch;
  }

  .message-text :deep(th),
  .message-text :deep(td) {
    min-width: 40px; /* 设置最小单元格宽度 */
    max-width: 250px; /* 限制最大单元格宽度 */
    word-break: break-word;
    overflow-wrap: break-word;
    box-sizing: border-box;
  }
}

/* 针对更小屏幕的优化 */
@media (max-width: 480px) {
  .message-text :deep(pre) {
    font-size: 12px; /* 在小屏幕上缩小代码字体 */
    padding: 8px;
    max-width: 100vw;
  }

  .message-text :deep(th),
  .message-text :deep(td) {
    min-width: 30px;
    max-width: 150px;
    padding: 6px 4px; /* 减小内边距 */
    font-size: 12px; /* 减小字体大小 */
    word-break: break-word;
    overflow-wrap: break-word;
  }
}

.message-file {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-top: 8px;
  padding: 8px 12px;
  background: rgba(232, 240, 255, 0.5);
  border-radius: 8px;
  font-size: 14px;
  color: #5a7bc1;
}

.error-actions {
  margin-top: 8px;
  display: flex;
  justify-content: flex-start;
}

.typing {
  display: flex;
  align-items: center;
  gap: 4px;
}

.typing-dot {
  width: 8px;
  height: 8px;
  background: #7a9ccc;
  border-radius: 50%;
  animation: typing 1.4s infinite ease-in-out;
}

.typing-dot:nth-child(1) { animation-delay: -0.32s; }
.typing-dot:nth-child(2) { animation-delay: -0.16s; }

@keyframes typing {
  0%, 80%, 100% { transform: scale(0); }
  40% { transform: scale(1); }
}

.input-area {
  padding: 20px;
  background: rgba(255, 255, 255, 0.9);
  border-top: 1px solid rgba(144, 180, 248, 0.3);
  flex-shrink: 0; /* 防止输入区域被压缩 */
}

.input-container {
  display: flex;
  gap: 12px;
  align-items: flex-end;
}

.message-input {
  flex: 1;
}

.message-input textarea {
  background: rgba(232, 240, 255, 0.3);
  border: 1px solid #c0d8e8;
  border-radius: 12px;
  resize: none;
  padding: 12px; /* 添加内边距 */
  font-family: inherit; /* 使用继承字体 */
  font-size: 14px; /* 明确设置字体大小 */
  line-height: 1.5; /* 提升行高 */
  transition: border-color 0.2s, box-shadow 0.2s; /* 添加平滑过渡效果 */
  /* 为textarea添加滚动条样式 */
  overflow-y: auto;
}

/* 为主输入区域textarea添加滚动条样式 */
.message-input textarea::-webkit-scrollbar {
  width: 6px;
}

.message-input textarea::-webkit-scrollbar-track {
  background: rgba(232, 240, 255, 0.3);
  border-radius: 3px;
}

.message-input textarea::-webkit-scrollbar-thumb {
  background: rgba(144, 180, 248, 0.5);
  border-radius: 3px;
}

.message-input textarea::-webkit-scrollbar-thumb:hover {
  background: rgba(144, 180, 248, 0.7);
}

.message-input textarea:focus {
  border-color: #90d8ff;
  box-shadow: 0 0 0 2px rgba(144, 180, 248, 0.2);
}

.input-actions {
  display: flex;
  gap: 8px;
  flex-direction: row;
}

/* 确保移动端输入区域的按钮都可见 */
.input-actions {
  display: flex;
  gap: 8px;
  flex-direction: row;
  align-self: flex-end; /* 确保按钮与输入框底部对齐 */
}

/* 针对软键盘弹出时的调整 */
.chat-container.keyboard-visible .input-area {
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  z-index: 100;
  border-top: 1px solid rgba(144, 180, 248, 0.3);
}

/* 修复Element Plus按钮默认边距在移动端的影响 */
.input-actions .el-button + .el-button {
  margin-left: 0;
}

/* 滚动条样式 */
.messages-container::-webkit-scrollbar {
  width: 6px;
}

.messages-container::-webkit-scrollbar-track {
  background: rgba(232, 240, 255, 0.3);
  border-radius: 3px;
}

.messages-container::-webkit-scrollbar-thumb {
  background: rgba(144, 180, 248, 0.5);
  border-radius: 3px;
}

.messages-container::-webkit-scrollbar-thumb:hover {
  background: rgba(144, 180, 248, 0.7);
}

/* 对话历史滚动条样式 */
.dialog-list::-webkit-scrollbar {
  width: 6px;
}

.dialog-list::-webkit-scrollbar-track {
  background: rgba(232, 240, 255, 0.3);
  border-radius: 3px;
}

.dialog-list::-webkit-scrollbar-thumb {
  background: rgba(144, 180, 248, 0.5);
  border-radius: 3px;
}

.dialog-list::-webkit-scrollbar-thumb:hover {
  background: rgba(144, 180, 248, 0.7);
}

/* 侧边栏滚动条样式 */
.chat-sidebar::-webkit-scrollbar {
  width: 6px;
}

.chat-sidebar::-webkit-scrollbar-track {
  background: rgba(232, 240, 255, 0.3);
  border-radius: 3px;
}

.chat-sidebar::-webkit-scrollbar-thumb {
  background: rgba(144, 180, 248, 0.5);
  border-radius: 3px;
}

.chat-sidebar::-webkit-scrollbar-thumb:hover {
  background: rgba(144, 180, 248, 0.7);
}

.divider {
  border: none;
  height: 1px;
  background: linear-gradient(to right, transparent, rgba(144, 180, 248, 0.3), transparent);
  margin: 10px 0;
}

.streaming-indicator {
  margin-top: 10px;
}

.typing-initial {
  margin-top: 10px;
}

.typing-placeholder {
  margin-bottom: 8px;
  color: #7a9ccc;
  font-style: italic;
  font-size: 14px;
}

.typing-continue {
  margin-top: 10px;
}

/* 侧边栏动画 */
.sidebar-slide-enter-active, .sidebar-slide-leave-active {
  transition: transform 0.3s ease, opacity 0.3s ease;
}
.sidebar-slide-enter-from, .sidebar-slide-leave-to {
  transform: translateX(-100%); opacity: 0;
}

/* 移动端侧边栏 */
.sidebar-mobile {
  position: fixed; left: 0; top: 0; height: 100%;              /* 替换 100vh */
  max-height: 100dvh;        /* 使用动态视口高度作为上限 */
  z-index: 1000;
  box-shadow: 4px 0 20px rgba(0,0,0,0.15);
  overflow-y: auto;          /* 确保移动端也能滚动 */
  -webkit-overflow-scrolling: touch;
}
.sidebar-overlay {
  position: fixed; inset: 0; background: rgba(0,0,0,0.3); z-index: 999;
}

/* 响应式断点 */
@media (max-width: 768px) {
  .chat-sidebar { width: 280px; }
  .message-content { max-width: 85%; }
  .input-area { padding: 12px; }
  .header-left { gap: 8px; }
  .header-right { gap: 8px; } /* 确保右侧按钮之间也有适当间距 */
  .sidebar-toggle-btn { margin-right: 8px; }

  /* 移动端调整标题和用户信息的显示 */
  .header-left {
    flex-wrap: wrap;
    min-height: 40px;
  }

  .header-left h2, .user-info {
    flex-shrink: 0;
  }

  /* 移动端确保头部元素正常显示 */
  .chat-header {
    flex-wrap: nowrap; /* 防止整个头部换行 */
    min-height: 60px; /* 确保有足够的空间容纳所有元素 */
  }

  .header-left, .header-right {
    min-height: 40px;
  }
}

@media (max-width: 480px) {
  .chat-sidebar { width: 100%; }
  .message-avatar { width: 32px; height: 32px; }
  .message-content { max-width: 80%; }
  .input-container { flex-direction: column; align-items: stretch; }
  .input-actions {
    flex-direction: row;
    align-items: center;
    margin-top: 12px;
  }
  .upload-trigger-btn { align-self: flex-start; margin-bottom: 12px; }

  /* 针对更小屏幕的头部布局优化 */
  .chat-header {
    padding: 12px 16px; /* 减少内边距 */
    min-height: 50px; /* 调整最小高度 */
  }

  .header-left h2 {
    font-size: 16px; /* 在小屏幕上减小字体 */
  }

  .user-info {
    font-size: 12px; /* 在小屏幕上减小字体 */
    max-width: 100px; /* 减小最大宽度 */
  }

  .header-right {
    gap: 6px; /* 在小屏幕上减少按钮间距 */
  }

  .theme-toggle-btn,
  .el-button[type="button"][size="small"] {
    padding: 6px; /* 减小按钮内边距 */
  }
}

/* 上下文设置部分样式 */
.context-settings-section {
  margin-top: 30px;
  padding-top: 20px;
  border-top: 1px solid rgba(144, 180, 248, 0.3);
}

.context-settings-section h3 {
  color: #5a7bc1;
  font-size: 16px;
  margin-bottom: 16px;
}

.context-slider-wrapper {
  padding: 12px 0;
}

.context-label {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 12px;
}

.context-hint {
  font-size: 12px;
  color: #7a9ccc;
  margin-top: 20px;
}

.sidebar-close-btn {
  position: absolute;
  top: 16px;
  right: 16px;
  z-index: 1001;
}

/* 角色设定部分样式 */
.system-prompt-section {
  margin-top: 20px;
  padding-top: 20px;
  border-top: 1px solid rgba(144, 180, 248, 0.3);
}

.system-prompt-section h3 {
  color: #5a7bc1;
  font-size: 16px;
  margin-bottom: 12px;
}

.system-prompt-section :deep(.el-textarea__inner) {
  background: rgba(232, 240, 255, 0.3);
  border: 1px solid #c0d8e8;
  border-radius: 8px;
  padding: 12px; /* 添加内边距 */
  font-family: inherit; /* 使用继承字体 */
  font-size: 14px; /* 明确设置字体大小 */
  line-height: 1.5; /* 提升行高 */
  transition: border-color 0.2s, box-shadow 0.2s; /* 添加平滑过渡效果 */
  /* 为系统提示textarea添加滚动条样式 */
  overflow-y: auto;
}

/* 为系统提示textarea添加滚动条样式 */
.system-prompt-section :deep(.el-textarea__inner::-webkit-scrollbar) {
  width: 6px;
}

.system-prompt-section :deep(.el-textarea__inner::-webkit-scrollbar-track) {
  background: rgba(232, 240, 255, 0.3);
  border-radius: 3px;
}

.system-prompt-section :deep(.el-textarea__inner::-webkit-scrollbar-thumb) {
  background: rgba(144, 180, 248, 0.5);
  border-radius: 3px;
}

.system-prompt-section :deep(.el-textarea__inner::-webkit-scrollbar-thumb:hover) {
  background: rgba(144, 180, 248, 0.7);
}

/* 系统提示textarea禁用状态滚动条样式 */
.system-prompt-section :deep(.el-textarea.is-disabled .el-textarea__inner::-webkit-scrollbar) {
  width: 6px;
}

.system-prompt-section :deep(.el-textarea.is-disabled .el-textarea__inner::-webkit-scrollbar-track) {
  background: rgba(232, 240, 255, 0.2);
  border-radius: 3px;
}

.system-prompt-section :deep(.el-textarea.is-disabled .el-textarea__inner::-webkit-scrollbar-thumb) {
  background: rgba(144, 180, 248, 0.3);
  border-radius: 3px;
}

.system-prompt-section :deep(.el-textarea.is-disabled .el-textarea__inner::-webkit-scrollbar-thumb:hover) {
  background: rgba(144, 180, 248, 0.4);
}

.system-prompt-section :deep(.el-textarea__inner:focus) {
  border-color: #90d8ff;
  box-shadow: 0 0 0 2px rgba(144, 180, 248, 0.2);
}

/* 增强角色部分样式 */
.enhanced-role-section {
  margin-top: 16px;
  padding-top: 16px;
  border-top: 1px dashed rgba(64, 158, 255, 0.3);
}

.enhanced-role-toggle {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 12px;
}

.enhanced-role-interface {
  margin-top: 12px;
}

.enhanced-role-interface :deep(.el-tabs__nav-wrap::after) {
  background: rgba(64, 158, 255, 0.2);
}

.enhanced-role-interface :deep(.el-tabs__item) {
  color: #606266;
}

.enhanced-role-interface :deep(.el-tabs__item.is-active) {
  color: #409eff;
  background: rgba(64, 158, 255, 0.1);
}

.enhanced-role-list {
  margin-top: 12px;
  max-height: 200px;
  overflow-y: auto;
  padding: 8px;
  border: 1px solid #c0d8e8; /* 采用与整体UI一致的蓝色系边框 */
  border-radius: 8px; /* 与整体设计保持一致 */
  background: rgba(232, 240, 255, 0.3); /* 采用与整体UI一致的背景 */
  -webkit-overflow-scrolling: touch; /* 启用iOS平滑滚动 */
}

/* 为增强角色列表添加滚动条样式 */
.enhanced-role-list::-webkit-scrollbar {
  width: 6px;
}

.enhanced-role-list::-webkit-scrollbar-track {
  background: rgba(232, 240, 255, 0.3);
  border-radius: 3px;
}

.enhanced-role-list::-webkit-scrollbar-thumb {
  background: rgba(144, 180, 248, 0.5);
  border-radius: 3px;
}

.enhanced-role-list::-webkit-scrollbar-thumb:hover {
  background: rgba(144, 180, 248, 0.7);
}

.enhanced-role-item {
  margin-bottom: 8px;
}

.enhanced-role-item:last-child {
  margin-bottom: 0;
}

.enhanced-role-radio {
  width: 100%;
  min-height: 64px; /* 设置最小高度，确保单选框看起来足够高 */
  padding: 14px 16px; /* 调整内边距 */
  border-radius: 8px;
  margin-bottom: 6px;
  display: flex;
  align-items: center; /* 垂直居中对齐 */
  transition: all 0.2s; /* 添加过渡效果 */
}

.enhanced-role-radio :deep(.el-radio__input) {
  margin-top: 0; /* 微调单选按钮的垂直位置 */
  margin-right: 12px; /* 增加单选按钮与内容间的间距 */
}

.enhanced-role-radio :deep(.el-radio__label) {
  flex: 1;
  padding-left: 0;
}

.enhanced-role-radio :deep(.el-radio__input .el-radio__inner) {
  border-color: #c0c4cc;
  width: 18px;
  height: 18px;
  margin-top: 0; /* 微调单选按钮的位置 */
}

.enhanced-role-radio.is-checked :deep(.el-radio__input .el-radio__inner) {
  background: #409eff;
  border-color: #409eff;
}

.enhanced-role-radio.is-checked {
  background: rgba(64, 158, 255, 0.1);
  border-color: transparent; /* 移除边框 */
}

.role-info {
  display: flex;
  flex-direction: column;
  gap: 6px; /* 调整间距 */
  align-items: flex-start; /* 左对齐文字 */
  flex: 1; /* 占据剩余空间 */
}

.role-name {
  font-weight: 500;
  color: #303133;
  margin: 0;
  padding: 0;
}

.role-desc {
  font-size: 12px;
  color: #909399;
  line-height: 1.4; /* 保持适当的行高 */
  margin: 0;
  padding: 0;
  max-width: 100%;
  overflow-wrap: break-word;
}

.enhanced-role-preview {
  margin-top: 16px;
  padding: 12px;
  background: rgba(64, 158, 255, 0.05);
  border: 1px solid rgba(64, 158, 255, 0.2);
  border-radius: 6px;
}

.enhanced-role-preview h4 {
  margin: 0 0 8px 0;
  color: #409eff;
  font-size: 14px;
}

.role-content-preview {
  font-size: 13px;
  line-height: 1.5;
  color: #606266;
  white-space: pre-wrap;
  overflow-wrap: break-word;
}

/* 深色主题下的增强角色样式 */
body.dark-theme .enhanced-role-section {
  border-top: 1px dashed rgba(85, 85, 85, 0.3);
}

body.dark-theme .enhanced-role-list {
  border: 1px solid #5a7bc1; /* 蓝色系边框 */
  background: rgba(50, 50, 50, 0.3);
  color: #e0e0e0;
}

/* 深色主题下增强角色列表的滚动条样式 */
body.dark-theme .enhanced-role-list::-webkit-scrollbar-track {
  background: rgba(50, 50, 50, 0.3);
}

body.dark-theme .enhanced-role-list::-webkit-scrollbar-thumb {
  background: rgba(90, 123, 193, 0.5);
}

body.dark-theme .enhanced-role-list::-webkit-scrollbar-thumb:hover {
  background: rgba(90, 123, 193, 0.7);
}

body.dark-theme .enhanced-role-radio {
  background: rgba(50, 50, 50, 0.3);
  border: 1px solid #4c4d4f;
  color: #e0e0e0;
  min-height: 64px; /* 保持一致的最小高度 */
  padding: 14px 16px; /* 调整内边距 */
  border-radius: 8px;
  display: flex;
  align-items: center; /* 垂直居中对齐 */
  transition: all 0.2s; /* 添加过渡效果 */
}

body.dark-theme .enhanced-role-radio :deep(.el-radio__input) {
  margin-top: 0; /* 微调单选按钮的垂直位置 */
  margin-right: 12px; /* 增加单选按钮与内容间的间距 */
}

body.dark-theme .enhanced-role-radio :deep(.el-radio__label) {
  flex: 1;
  padding-left: 0;
}

body.dark-theme .enhanced-role-radio :deep(.el-radio__input .el-radio__inner) {
  border-color: #555;
  background: #333;
  width: 18px;
  height: 18px;
  margin-top: 0; /* 微调单选按钮的位置 */
}

body.dark-theme .enhanced-role-radio.is-checked :deep(.el-radio__input .el-radio__inner) {
  background: #409eff;
  border-color: #409eff;
}

body.dark-theme .enhanced-role-radio.is-checked {
  background: rgba(64, 158, 255, 0.1);
  border-color: transparent; /* 移除边框 */
}

body.dark-theme .role-name {
  color: #e0e0e0;
}

body.dark-theme .role-desc {
  color: #9a9a9a;
}

body.dark-theme .enhanced-role-preview {
  background: rgba(64, 158, 255, 0.05);
  border: 1px solid rgba(85, 85, 85, 0.2);
  color: #e0e0e0;
}

body.dark-theme .role-content-preview {
  color: #aaa;
}

body.dark-theme .enhanced-role-interface :deep(.el-tabs__item) {
  color: #aaa;
}

body.dark-theme .enhanced-role-interface :deep(.el-tabs__item.is-active) {
  color: #409eff;
  background: rgba(64, 158, 255, 0.1);
}

/* 发送键偏好设置部分样式 */
.send-preference-section {
  margin-top: 20px;
  padding-top: 20px;
  border-top: 1px solid rgba(144, 180, 248, 0.3);
}

.send-preference-section h3 {
  color: #5a7bc1;
  font-size: 16px;
  margin-bottom: 12px;
}

.send-preference-wrapper {
  padding: 12px 0;
}

.send-preference-hint {
  font-size: 12px;
  color: #7a9ccc;
  margin-top: 8px;
}

/* 字体大小控制样式 */
.font-size-controls {
  display: flex;
  align-items: center;
  gap: 8px;
  margin: 0 15px;
}

.font-size-label {
  white-space: nowrap;
}

.messages-container {
  /* 小字体 */
  &:not(.font-medium):not(.font-large) {
    font-size: 12px;
  }

  /* 中等字体 */
  &.font-medium {
    font-size: 14px;
  }

  /* 大字体 */
  &.font-large {
    font-size: 16px;
  }
}

.message-text {
  /* 小字体 */
  .messages-container:not(.font-medium):not(.font-large) & {
    font-size: 12px;
  }

  /* 中等字体 */
  .messages-container.font-medium & {
    font-size: 14px;
  }

  /* 大字体 */
  .messages-container.font-large & {
    font-size: 16px;
  }
}

.messages-container-temp {
  position: absolute;
  left: -9999px;
  background-color: #f9f7f0 !important;
  padding: 20px !important;
  box-sizing: border-box !important;
  width: 100% !important;
}

.action-buttons {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
}

/* 响应式断点 */
@media (max-width: 768px) {
  .chat-sidebar { width: 280px; }
  .message-content { max-width: 85%; }
  .input-area { padding: 12px; }
  .header-left { gap: 8px; }
  .sidebar-toggle-btn { margin-right: 8px; }

  /* 在移动端隐藏桌面端toolbar，显示移动端toolbar按钮 */
  .toolbar-desktop {
    display: none;
  }

  .toolbar-mobile {
    display: flex;
  }

  .dialog-title-editor,
  .font-size-controls {
    width: 100%;
    margin-right: 0;
  }

  .font-size-controls {
    display: flex;
    flex-direction: column;
    align-items: flex-start;
  }

  .font-size-label {
    margin-bottom: 8px;
  }

  .action-buttons {
    flex-direction: column;
  }

  /* 优化移动端按钮的宽度控制 */
  .action-buttons .el-button {
    width: 100%;
    max-width: 100%;
    flex: 1;
    min-width: auto;
  }

  /* 修复Element Plus按钮默认边距在移动端的影响 */
  .action-buttons .el-button + .el-button {
    margin-left: 0;
  }
}

@media (max-width: 480px) {
  .chat-sidebar { width: 100%; }
  .message-avatar { width: 32px; height: 32px; }
  .message-content { max-width: 80%; }
  .input-container { flex-direction: column; align-items: stretch; }
  .input-actions {
    flex-direction: row;
    align-items: center;
    margin-top: 12px;
    justify-content: flex-end; /* 确保按钮靠右对齐 */
    width: 100%; /* 确保动作区占满整行 */
    flex-wrap: wrap; /* 允许换行以适应小屏幕 */
  }
  .upload-trigger-btn { align-self: flex-end; margin-bottom: 0; }

  .action-buttons {
    width: 100%;
  }

  /* 进一步优化小屏幕上的按钮样式 */
  .action-buttons .el-button {
    width: 100%;
    max-width: 100%;
    min-width: auto;
  }

  .dialog-title-editor {
    width: 100%;
    margin-right: 0;
  }

  /* 修复Element Plus按钮默认边距在移动端的影响 */
  .action-buttons .el-button + .el-button {
    margin-left: 0;
  }

  /* 确保输入框和按钮都能适应小屏幕 */
  .input-area {
    padding: 12px;
  }

  /* 确保按钮不会因为太宽而挤压输入框 */
  .input-actions .el-button {
    flex-shrink: 0;
  }

  /* 确保发送按钮在移动端可见 */
  .input-actions .el-button--primary {
    min-width: 60px; /* 确保发送按钮有最小宽度 */
  }
}

/* Android设备特定优化 */
@media screen and (-webkit-device-pixel-ratio: 1.5), screen and (-webkit-device-pixel-ratio: 2), screen and (-webkit-device-pixel-ratio: 3) {
  .chat-sidebar,
  .sidebar-mobile,
  .dialog-list {
    /* 在Android设备上增强滚动性能 */
    will-change: scroll-position;
    transform: translateZ(0);
    -webkit-transform: translateZ(0);
  }
}

/* 特别针对Android设备的表格和代码块优化 */
@media screen and (-webkit-device-pixel-ratio: 1.5), screen and (-webkit-device-pixel-ratio: 2), screen and (-webkit-device-pixel-ratio: 3) {
  .message-text :deep(pre) {
    max-width: 100%;
    width: 100%;
    overflow-x: auto;
    word-wrap: break-word;
    white-space: pre-wrap;
    word-break: break-word;
    box-sizing: border-box;
  }

  .message-text :deep(code) {
    max-width: 100%;
    overflow-x: auto;
    word-wrap: break-word;
    word-break: break-word;
    box-sizing: border-box;
  }

  .message-text :deep(table) {
    max-width: 100%;
    width: 100%;
    overflow-x: auto;
    display: block;
    table-layout: fixed;
    box-sizing: border-box;
  }

  .message-text :deep(th),
  .message-text :deep(td) {
    word-break: break-word;
    overflow-wrap: break-word;
    max-width: 100%;
    box-sizing: border-box;
  }

  .messages-container {
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
  }
}

/* 针对所有设备的进一步表格和代码块优化 */
.message-text :deep(pre) {
  max-width: 100vw;
  width: auto;
  overflow-x: auto;
  word-wrap: break-word;
  white-space: pre-wrap;
  word-break: break-word;
  box-sizing: border-box;
  /* 防止横向滚动条影响布局 */
  -webkit-overflow-scrolling: touch;
  /* 确保不会超出容器边界 */
  margin: 0;
  padding: 12px;
  border-radius: 8px;
  display: block;
}

.message-text :deep(code) {
  max-width: 100vw;
  overflow-x: auto;
  word-wrap: break-word;
  word-break: break-word;
  box-sizing: border-box;
  /* 对于行内代码，确保不破坏布局 */
  display: inline;
  vertical-align: middle;
  /* 限制行内代码块的最大宽度 */
  max-width: 100%;
}

.message-text :deep(pre code) {
  background: none !important;
  color: inherit !important;
  padding: 0 !important;
  font-size: inherit;
  white-space: inherit;
  display: block;
}

.message-text :deep(table) {
  max-width: 100%;
  width: fit-content;
  overflow-x: auto;
  display: block;
  table-layout: fixed;
  box-sizing: border-box;
  /* 确保表格容器能够滚动 */
  -webkit-overflow-scrolling: touch;
  margin: 0;
  border-collapse: collapse;
  /* 强制表格成为滚动容器 */
  display: table;
}

.message-text :deep(tr) {
  display: table-row;
  width: 100%;
}

.message-text :deep(th),
.message-text :deep(td) {
  word-break: break-word;
  overflow-wrap: break-word;
  box-sizing: border-box;
  /* 设置最小宽度以确保内容可读性 */
  min-width: 30px;
  max-width: calc(100vw - 20px);
  padding: 8px 12px;
  /* 限制单元格的最大宽度 */
  max-inline-size: 200px;
  /* 在窄屏上强制内容换行 */
  overflow-wrap: break-word;
  word-wrap: break-word;
  word-break: break-word;
  display: table-cell;
}

/* 移动端视口高度调整 */
@supports (-webkit-touch-callout: none) {
  /* iOS Safari */
  .chat-container {
    height: -webkit-fill-available;
  }
}

@supports (height: -webkit-fill-available) {
  /* Chrome, Firefox on mobile */
  .chat-container {
    height: -webkit-fill-available;
  }
}

@supports (height: 100dvh) {
  /* Modern browsers supporting dynamic viewport height */
  .chat-container {
    height: 100dvh;
  }
}

/* 修复软键盘弹出时的布局问题 */
@media screen and (max-height: 600px) and (orientation: portrait) {
  .chat-content {
    height: 100%;
  }

  .messages-container {
    height: calc(100% - 100px); /* 为输入区域留出空间 */
  }

  .input-area {
    position: sticky;
    bottom: 0;
    z-index: 10;
  }
}

.system-prompt-hint {
  font-size: 12px;
  color: #7a9ccc;
  margin-top: 8px;
}

/* 角色设定选项卡样式 */
.role-tabs {
  display: flex;
  gap: 4px;
  margin-top: 12px;
  flex-wrap: wrap;
}

.role-tab {
  padding: 6px 12px;
  font-size: 12px;
  border: 1px solid #c0d8e8;
  border-radius: 4px 4px 0 0;
  background: rgba(232, 240, 255, 0.3);
  cursor: pointer;
  transition: all 0.2s;
  display: flex;
  align-items: center;
  gap: 4px;
  min-height: 28px; /* 确保有足够空间容纳按钮 */
  box-sizing: border-box;
}

.role-tab:hover {
  background: rgba(144, 180, 248, 0.3);
}

.role-tab.active {
  background: rgba(144, 180, 248, 0.5);
  border-bottom-color: transparent;
  font-weight: 500;
}

/* 为增强角色的tab文字添加深色样式 */
.role-tab.enhanced-role {
  color: #333; /* 深色文字 */
}

.role-tab.add-tab {
  padding: 6px 8px;
}

/* 角色选项卡操作按钮样式 */
.role-tab-actions {
  opacity: 0;
  visibility: hidden;
  transition: opacity 0.2s ease-in-out, visibility 0.2s ease-in-out;
  display: flex;
  align-items: center;
  margin-left: 4px;
  position: relative; /* 确保不脱离文档流 */
}

.role-tab:hover .role-tab-actions {
  opacity: 1;
  visibility: visible;
}

.role-action-btn {
  width: 18px;
  height: 18px;
  padding: 2px;
  min-height: 18px;
}

/* 页面固定水印 */
.copyright-watermark-fixed {
  position: fixed;
  bottom: 8px;
  right: 12px;
  font-size: 11px;
  color: rgba(90, 123, 193, 0.5);
  z-index: 100;
  pointer-events: auto;
}

.copyright-watermark-fixed a {
  color: rgba(90, 123, 193, 0.6);
  text-decoration: none;
}

.copyright-watermark-fixed a:hover {
  color: #5a7bc1;
  text-decoration: underline;
}

/* 对话内容区域内嵌水印（长截图可见） */
.copyright-watermark-inline {
  text-align: center;
  padding: 16px 0;
  margin-top: 20px;
  font-size: 11px;
  color: rgba(90, 123, 193, 0.4);
  border-top: 1px dashed rgba(144, 180, 248, 0.3);
}

.github-link-inline {
  text-align: center;
  padding: 8px 0;
  margin-top: 8px;
  font-size: 12px;
  color: rgba(90, 123, 193, 0.6);
  border-top: 1px dotted rgba(144, 180, 248, 0.2);
}

.github-link-inline a {
  color: rgba(90, 123, 193, 0.8);
  text-decoration: none;
  font-weight: 500;
  display: inline-flex;
  align-items: center;
  gap: 4px;
}

.github-link-inline a:hover {
  color: #5a7bc1;
  text-decoration: underline;
}

.github-link-inline .wechat-info {
  margin-left: 15px;
  color: rgba(90, 123, 193, 0.8);
  font-weight: 500;
  display: inline-flex;
  align-items: center;
  vertical-align: top;
  line-height: 1.3;
}

.github-link-inline .wechat-info:hover {
  color: #5a7bc1;
}

/* 回到顶部按钮样式 */
.back-to-top-btn {
  position: sticky;
  bottom: 20px;
  align-self: flex-end;
  margin-bottom: 20px;
  margin-right: 20px;
  width: 40px;
  height: 40px;
  border-radius: 50%;
  background: rgba(90, 123, 193, 0.8);
  color: white;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
  transition: all 0.3s ease;
  z-index: 100;
}

.back-to-top-btn:hover {
  background: rgba(90, 123, 193, 1);
  transform: translateY(-2px);
  box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
}

/* 用量查询弹窗样式 */
.usage-btn {
  margin-left: 10px;
  background: linear-gradient(135deg, #ffd700 0%, #ffa500 100%);
  border: none;
  color: white;
}

.usage-btn:hover {
  background: linear-gradient(135deg, #ffcc00 0%, #ff8c00 100%);
  color: white;
}

.usage-content {
  min-width: 280px;
}

.loading {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 10px 0;
  color: #909399;
}

.error {
  color: #f56c6c;
  padding: 10px 0;
  text-align: center;
}

.usage-data {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.usage-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 5px 0;
  border-bottom: 1px solid #f0f0f0;
}

.usage-item:last-child {
  border-bottom: none;
}

.usage-item .label {
  color: #606266;
  font-size: 14px;
}

.usage-item .value {
  color: #303133;
  font-weight: 500;
  font-size: 14px;
}

.usage-item.low-balance .value {
  color: #f56c6c;
  font-weight: bold;
}

/* 消息附件样式 */
.message-attachments {
  margin-top: 8px;
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
}

.attachment-preview {
  max-width: 100%;
  max-height: 300px;
  width: auto;
  height: auto;
  border-radius: 8px;
  cursor: pointer;
  transition: transform 0.2s;
  border: 1px solid #e4e7ed;
  object-fit: contain;
}

.attachment-preview:hover {
  transform: scale(1.05);
  border-color: #c0d8e8;
}

/* 针对小屏幕设备的图片优化 */
@media (max-width: 768px) {
  .attachment-preview {
    max-height: 200px;
  }
}

/* 针对大屏幕设备的图片优化 */
@media (min-width: 1200px) {
  .attachment-preview {
    max-height: 400px;
  }
}

.attachment-link {
  display: flex;
  align-items: center;
  gap: 4px;
  padding: 4px 8px;
  background: #f0f0f0;
  border-radius: 4px;
  color: #666;
  text-decoration: none;
  border: 1px solid #e4e7ed;
}

.attachment-link:hover {
  background: #e6f7ff;
  border-color: #90d8ff;
  color: #1890ff;
}

.image-preview-dialog .el-dialog__body {
  padding: 0;
  text-align: center;
}

/* 响应式设计：移动端用量弹窗样式 */
@media (max-width: 768px) {
  .usage-content {
    min-width: 250px;
  }

  .usage-item {
    flex-direction: column;
    align-items: flex-start;
    gap: 4px;
  }

  .usage-item .label,
  .usage-item .value {
    font-size: 13px;
  }
}

/* 深色主题下系统提示textarea禁用状态样式 */
body.dark-theme .system-prompt-section :deep(.el-textarea.is-disabled .el-textarea__inner) {
  background-color: #2a2a2a;
  border: 1px solid #555555;
  box-shadow: 0 0 0 1px #555555 inset;
  color: #9a9a9a;
  cursor: not-allowed;
}

/* 深色主题样式 */
body.dark-theme .chat-container {
  background: linear-gradient(135deg, #1a1a1a 0%, #2a2a2a 100%);
  color: #e0e0e0;
}

/* 深色主题下抽屉样式 */
body.dark-theme .el-drawer {
  --el-bg-color: #2a2a2a;
  --el-text-color-primary: #e0e0e0;
  background-color: #2a2a2a;
  color: #e0e0e0;
}

body.dark-theme .el-drawer__header {
  color: #e0e0e0;
  border-bottom: 1px solid #4a4a4a;
  margin-bottom: 16px;
  padding-bottom: 12px;
}

body.dark-theme .el-drawer__body {
  background-color: #2a2a2a;
  color: #e0e0e0;
  padding: 20px;
}

/* 深色主题下移动端抽屉内容样式 */
body.dark-theme .mobile-toolbar-content {
  background-color: #2a2a2a;
  color: #e0e0e0;
}

body.dark-theme .mobile-form-label {
  color: #e0e0e0;
}

body.dark-theme .chat-header {
  background: rgba(34, 34, 34, 0.9);
  backdrop-filter: blur(10px);
  border-bottom: 1px solid rgba(85, 85, 85, 0.3);
  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
  color: #e0e0e0;
}

body.dark-theme .header-left h2 {
  color: #e0e0e0;
}

body.dark-theme .user-info {
  color: #9a9a9a;
}

body.dark-theme .usage-btn {
  background: linear-gradient(135deg, #b8860b 0%, #daa520 100%);
  border: none;
  color: white;
}

body.dark-theme .usage-btn:hover {
  background: linear-gradient(135deg, #c8a620 0%, #eaaa30 100%);
  color: white;
}

body.dark-theme .usage-content {
  color: #e0e0e0;
}

body.dark-theme .usage-item {
  border-bottom: 1px solid #444;
}

body.dark-theme .usage-item .label {
  color: #aaa;
}

body.dark-theme .usage-item .value {
  color: #ddd;
}

body.dark-theme .usage-item.low-balance .value {
  color: #ff6b6b;
}

body.dark-theme .chat-sidebar {
  background: rgba(34, 34, 34, 0.9);
  backdrop-filter: blur(10px);
  border-right: 1px solid rgba(85, 85, 85, 0.3);
  color: #e0e0e0;
}

body.dark-theme .sidebar-close-btn {
  background-color: #333;
  border: 1px solid #555;
  color: white;
}

body.dark-theme .model-selector h3 {
  color: #e0e0e0;
}

body.dark-theme .dialog-history-section {
  border-top: 1px solid rgba(85, 85, 85, 0.3);
}

body.dark-theme .dialog-history-section h3 {
  color: #e0e0e0;
}

body.dark-theme .dialog-list {
  border: 1px solid #555;
  background: rgba(50, 50, 50, 0.7);
  color: #e0e0e0;
}

body.dark-theme .dialog-item {
  background: rgba(50, 50, 50, 0.5);
  border: 1px solid #555;
  color: #e0e0e0;
}

body.dark-theme .dialog-item.selected {
  background: rgba(122, 168, 122, 0.5);
  outline: 2px solid rgba(122, 168, 122, 0.8);
}

body.dark-theme .dialog-item:hover {
  background: rgba(122, 168, 122, 0.3);
}

body.dark-theme .dialog-title {
  color: #e0e0e0;
}

body.dark-theme .dialog-date {
  color: #9a9a9a;
}

body.dark-theme .no-dialogs {
  color: #7a7a7a;
}

body.dark-theme .delete-btn {
  color: #e0e0e0;
}

body.dark-theme .context-settings-section {
  border-top: 1px solid rgba(85, 85, 85, 0.3);
}

body.dark-theme .context-label {
  color: #e0e0e0;
}

body.dark-theme .context-hint {
  color: #9a9a9a;
}

body.dark-theme .system-prompt-section {
  border-top: 1px solid rgba(85, 85, 85, 0.3);
}

body.dark-theme .system-prompt-section h3 {
  color: #e0e0e0;
}

body.dark-theme .system-prompt-hint {
  color: #9a9a9a;
}

/* 深色主题下的系统提示输入框样式 */
body.dark-theme .system-prompt-section :deep(.el-textarea__inner) {
  background: rgba(50, 50, 50, 0.3);
  border: 1px solid #5a7bc1; /* 蓝色系边框 */
  color: #e0e0e0;
  padding: 12px; /* 保持一致的内边距 */
}

body.dark-theme .role-tabs {
  border-top: 1px solid rgba(85, 85, 85, 0.3);
}

body.dark-theme .role-tab {
  background: rgba(50, 50, 50, 0.3);
  border: 1px solid #5a7bc1; /* 蓝色系边框 */
  color: #e0e0e0; /* 保持原有文字颜色 */
  min-height: 28px;
  box-sizing: border-box;
}

body.dark-theme .role-tab:hover {
  background: rgba(90, 123, 193, 0.3); /* 蓝色系悬停背景 */
}

body.dark-theme .role-tab.active {
  background: rgba(90, 123, 193, 0.5); /* 蓝色系激活背景 */
  border-bottom-color: transparent;
  color: white;
}

/* 为增强角色的tab文字添加深色样式（白色字） */
body.dark-theme .role-tab.enhanced-role {
  color: white; /* 白色文字 */
}

body.dark-theme .send-preference-section {
  border-top: 1px solid rgba(85, 85, 85, 0.3);
}

body.dark-theme .send-preference-section h3 {
  color: #e0e0e0;
}

body.dark-theme .send-preference-hint {
  color: #9a9a9a;
}

body.dark-theme .chat-content {
  background: rgba(34, 34, 34, 0.7);
  color: #e0e0e0;
}

body.dark-theme .chat-toolbar {
  background: rgba(34, 34, 34, 0.8);
  border-bottom: 1px solid rgba(85, 85, 85, 0.3);
  color: #e0e0e0;
}

body.dark-theme .messages-container {
  background-color: #222;
  color: #e0e0e0;
  overflow-x: auto; /* 添加横向滚动 */
  -webkit-overflow-scrolling: touch; /* 启用触摸滚动 */
}

body.dark-theme .message-avatar {
  background: linear-gradient(135deg, #555 0%, #777 100%);
  color: white;
}

body.dark-theme .message.user .message-avatar {
  background: linear-gradient(135deg, #555 0%, #777 100%);
}

body.dark-theme .message-author {
  color: #e0e0e0;
}

body.dark-theme .message-time {
  color: #9a9a9a;
}

body.dark-theme .message-actions .el-button {
  color: #9a9a9a;
}

body.dark-theme .message-text {
  background: rgba(50, 50, 50, 0.9);
  border: 1px solid rgba(85, 85, 85, 0.3);
  color: #e0e0e0;
}

body.dark-theme .message.user .message-text {
  background: rgba(70, 70, 70, 0.5);
  border-color: rgba(85, 85, 85, 0.5);
}

body.dark-theme .message-text :deep(pre) {
  background: #2d2d2d !important;
  color: #ddd !important;
}

body.dark-theme .message-text :deep(*) {
  max-width: 100%;
  overflow-wrap: break-word;
  word-wrap: break-word;
  word-break: break-word;
  box-sizing: border-box;
}

body.dark-theme .message-text :deep(code) {
  background: rgba(100, 100, 100, 0.2);
  color: #ddd;
}

body.dark-theme .message-text :deep(blockquote) {
  border-left: 3px solid #5a7bc1;
  color: #ccc;
  max-width: 100%;
  overflow-wrap: break-word;
  word-wrap: break-word;
  word-break: break-word;
  box-sizing: border-box;
}

/* 深色主题下移动端适配 */
@media (max-width: 768px) {
  body.dark-theme .toolbar-mobile {
    background: rgba(34, 34, 34, 0.8);
    border-bottom: 1px solid rgba(85, 85, 85, 0.3);
  }

  body.dark-theme .mobile-form-label {
    color: #e0e0e0;
  }

  body.dark-theme .message-text :deep(pre) {
    max-width: 100vw;
    width: auto;
    overflow-x: auto;
    word-wrap: break-word;
    white-space: pre-wrap;
    box-sizing: border-box;
    -webkit-overflow-scrolling: touch;
  }

  body.dark-theme .message-text :deep(code) {
    max-width: 100vw;
    overflow-x: auto;
    word-wrap: break-word;
    word-break: break-word;
    box-sizing: border-box;
  }

  body.dark-theme .message-text :deep(table) {
    max-width: 100%;
    width: fit-content;
    overflow-x: auto;
    display: block;
    table-layout: fixed;
    box-sizing: border-box;
    -webkit-overflow-scrolling: touch;
  }

  body.dark-theme .message-text :deep(th),
  body.dark-theme .message-text :deep(td) {
    min-width: 40px;
    max-width: 250px;
    word-break: break-word;
    overflow-wrap: break-word;
    box-sizing: border-box;
  }
}

/* 深色主题下更小屏幕的优化 */
@media (max-width: 480px) {
  body.dark-theme .message-text :deep(pre) {
    font-size: 12px;
    padding: 8px;
    max-width: 100vw;
  }

  body.dark-theme .message-text :deep(th),
  body.dark-theme .message-text :deep(td) {
    min-width: 30px;
    max-width: 150px;
    padding: 6px 4px;
    font-size: 12px;
    word-break: break-word;
    overflow-wrap: break-word;
  }
}

body.dark-theme .message-file {
  background: rgba(50, 50, 50, 0.5);
  color: #e0e0e0;
}

body.dark-theme .typing-placeholder {
  color: #9a9a9a;
}

body.dark-theme .typing-dot {
  background: #9a9a9a;
}

body.dark-theme .input-area {
  background: rgba(34, 34, 34, 0.9);
  border-top: 1px solid rgba(85, 85, 85, 0.3);
}

body.dark-theme .message-input textarea {
  background: rgba(50, 50, 50, 0.3);
  border: 1px solid #5a7bc1; /* 蓝色系边框 */
  color: #e0e0e0;
  padding: 12px; /* 保持一致的内边距 */
}

/* 深色主题下主输入区域textarea滚动条样式 */
body.dark-theme .message-input textarea::-webkit-scrollbar-track {
  background: rgba(50, 50, 50, 0.3);
}

body.dark-theme .message-input textarea::-webkit-scrollbar-thumb {
  background: rgba(90, 123, 193, 0.5);
}

body.dark-theme .message-input textarea::-webkit-scrollbar-thumb:hover {
  background: rgba(90, 123, 193, 0.7);
}

body.dark-theme .message-input textarea:focus {
  border-color: #5a7bc1;
  box-shadow: 0 0 0 2px rgba(90, 123, 193, 0.2);
}

body.dark-theme .upload-popover-content {
  background-color: #222;
  border: 1px solid #555;
  color: #e0e0e0;
}

body.dark-theme .upload-popover-header {
  color: #e0e0e0;
}

/* 深色主题下Android设备优化 */
@media screen and (-webkit-device-pixel-ratio: 1.5), screen and (-webkit-device-pixel-ratio: 2), screen and (-webkit-device-pixel-ratio: 3) {
  body.dark-theme .message-text :deep(pre) {
    max-width: 100%;
    width: 100%;
    overflow-x: auto;
    word-wrap: break-word;
    white-space: pre-wrap;
    word-break: break-word;
    box-sizing: border-box;
  }

  body.dark-theme .message-text :deep(code) {
    max-width: 100%;
    overflow-x: auto;
    word-wrap: break-word;
    word-break: break-word;
    box-sizing: border-box;
  }

  body.dark-theme .message-text :deep(table) {
    max-width: 100%;
    width: 100%;
    overflow-x: auto;
    display: block;
    table-layout: fixed;
    box-sizing: border-box;
  }

  body.dark-theme .message-text :deep(th),
  body.dark-theme .message-text :deep(td) {
    word-break: break-word;
    overflow-wrap: break-word;
    max-width: 100%;
    box-sizing: border-box;
  }

  body.dark-theme .messages-container {
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
  }
}

body.dark-theme .messages-container::-webkit-scrollbar-track {
  background: rgba(50, 50, 50, 0.3);
}

body.dark-theme .messages-container::-webkit-scrollbar-thumb {
  background: rgba(90, 123, 193, 0.5);
}

body.dark-theme .messages-container::-webkit-scrollbar-thumb:hover {
  background: rgba(90, 123, 193, 0.7);
}

body.dark-theme .dialog-list::-webkit-scrollbar-track {
  background: rgba(50, 50, 50, 0.3);
}

body.dark-theme .dialog-list::-webkit-scrollbar-thumb {
  background: rgba(90, 123, 193, 0.5);
}

body.dark-theme .dialog-list::-webkit-scrollbar-thumb:hover {
  background: rgba(90, 123, 193, 0.7);
}

body.dark-theme .chat-sidebar::-webkit-scrollbar-track {
  background: rgba(50, 50, 50, 0.3);
}

body.dark-theme .chat-sidebar::-webkit-scrollbar-thumb {
  background: rgba(90, 123, 193, 0.5);
}

body.dark-theme .chat-sidebar::-webkit-scrollbar-thumb:hover {
  background: rgba(90, 123, 193, 0.7);
}

body.dark-theme .divider {
  background: linear-gradient(to right, transparent, rgba(90, 123, 193, 0.3), transparent);
}

body.dark-theme .copyright-watermark-inline {
  color: rgba(224, 224, 224, 0.4);
  border-top: 1px dashed rgba(90, 123, 193, 0.3);
}

body.dark-theme .github-link-inline {
  color: rgba(224, 224, 224, 0.6);
  border-top: 1px dotted rgba(90, 123, 193, 0.2);
}

body.dark-theme .github-link-inline a {
  color: rgba(224, 224, 224, 0.8);
}

body.dark-theme .github-link-inline a:hover {
  color: #e0e0e0;
}

body.dark-theme .back-to-top-btn {
  background: rgba(90, 123, 193, 0.8);
  color: white;
}

body.dark-theme .back-to-top-btn:hover {
  background: rgba(90, 123, 193, 1);
}

body.dark-theme .message-attachments {
  color: #e0e0e0;
}

body.dark-theme .attachment-preview {
  border: 1px solid #555;
}

body.dark-theme .attachment-preview:hover {
  border-color: #5a7bc1;
}

body.dark-theme .attachment-link {
  background: #444;
  border: 1px solid #555;
  color: #ccc;
}

body.dark-theme .attachment-link:hover {
  background: #555;
  border-color: #5a7bc1;
  color: #fff;
}

body.dark-theme .sidebar-overlay {
  background: rgba(0, 0, 0, 0.5);
}

body.dark-theme .messages-container-temp {
  background-color: #1a1a1a !important;
}

body.dark-theme .theme-toggle-btn {
  background-color: #333;
  border: 1px solid #555;
  color: white;
}

/* 深色主题下移动设备的按钮样式 */
@media (max-width: 768px) {
  body.dark-theme .theme-toggle-btn {
    background-color: #333;
    border: 1px solid #555;
    color: white;
  }
}

/* 禁用状态的样式 */
.role-tabs.disabled {
  opacity: 0.5;
  pointer-events: none;
}

/* 截断消息样式 */
.truncated-actions {
  margin-top: 12px;
  padding-top: 12px;
  border-top: 1px dashed rgba(144, 180, 248, 0.4);
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
}

.truncated-indicator {
  display: flex;
  align-items: center;
  gap: 8px;
}

.truncated-indicator .ellipsis {
  font-size: 18px;
  font-weight: bold;
  color: #e6a23c;
  letter-spacing: 2px;
}

.truncated-indicator .truncated-hint {
  font-size: 12px;
  color: #909399;
}

@media (max-width: 768px) {
  .truncated-actions {
    flex-direction: column;
    align-items: flex-start;
    gap: 8px;
  }
}

.chat-container {
  /* 原有样式 */
}

.chat-header {
  /* 原有样式 */
}

/* 主题切换按钮样式 */
.theme-toggle-btn {
  margin-right: 10px;
  background-color: #f5f5f5;
  border: 1px solid #dcdfe6;
}

/* 模型描述样式 */
.model-description {
  margin-top: 10px;
}

.model-desc-text {
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 14px;
  color: #606266;
  line-height: 1.5;
}

/* 数学公式样式 */
.katex-display {
  margin: 0.5em 0;
  overflow-x: auto;
  overflow-y: hidden;
}

/* LaTeX 帮助对话框样式 */
.latex-help-content h3,
.latex-help-content h4 {
  margin: 16px 0 8px 0;
  color: #303133;
}

.latex-help-content p {
  margin: 8px 0;
  line-height: 1.6;
}

.latex-help-content code {
  padding: 2px 4px;
  margin: 0 2px;
  border-radius: 3px;
  background-color: #f5f5f5;
  font-family: monospace;
  font-size: 0.9em;
}

.example-formulas {
  background-color: #f9f9f9;
  padding: 15px;
  border-radius: 5px;
  margin: 10px 0;
}

/* 深色主题下的 LaTeX 帮助对话框样式 */
body.dark-theme .latex-help-content h3,
body.dark-theme .latex-help-content h4 {
  color: #e0e0e0;
}

body.dark-theme .latex-help-content p {
  color: #e0e0e0;
}

body.dark-theme .latex-help-content code {
  background-color: #4a4a4a;
  color: #e0e0e0;
}

/* 修复ElDialog标题的夜间模式样式 - 使用CSS变量 */
body.dark-theme {
  --el-text-color-primary: #e0e0e0;
}

/* 修复ElDialog头部和其他组件的夜间模式样式 */
body.dark-theme .el-dialog__header {
  border-bottom: 1px solid #4a4a4a;
}

body.dark-theme .el-dialog__body {
  background-color: #1a1a1a;
  color: #e0e0e0;
}

body.dark-theme .example-formulas {
  background-color: #3a3a3a;
  color: #e0e0e0;
}

/* 空响应操作按钮样式 */
.empty-response-actions {
  margin-top: 8px;
}

.empty-response-actions .el-alert {
  margin-bottom: 8px;
}

.empty-response-actions .el-button {
  margin-left: 0;
}